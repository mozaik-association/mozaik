<?xml version='1.0' encoding='UTF-8' ?>
<openerp>
    <data noupdate="0">

         <!-- Search and Tree Views -->

        <record id="mandate_category_search_view" model="ir.ui.view">
            <field name="name">mandate.category.search</field>
            <field name="model">mandate.category</field>
            <field name="arch" type="xml">
                <search string="Mandate Categories" version="7.0">
                    <field name="name"/>
                    <field name="sta_assembly_category_id" invisible="context.get('default_type', False)!='sta'"/>
                    <field name="int_assembly_category_id" invisible="context.get('default_type', False)!='int'"/>
                    <field name="ext_assembly_category_id" invisible="context.get('default_type', False)!='ext'"/>

                    <filter name="is_submission_mandate" string="Wage Declaration"
                            domain="[('is_submission_mandate','=',True)]" invisible="context.get('default_type', False)=='int'" />
                    <separator />
                    <filter name="is_submission_assets" string="Assets Declaration"
                            domain="[('is_submission_assets','=',True)]" invisible="context.get('default_type', False)=='int'" />
                    <separator />
                    <filter name="expired" string="Expired"
                            context="{'invisible_expire_date': False}"
                            domain="[('active','=',False)]" help="Expired Categories" />
                    <filter name="all" string="All"
                            context="{'invisible_expire_date': False}"
                            domain="['|', ('active', '=', True), ('active', '!=', True)]" help="All Categories, expired or not" />

                    <group expand="0" string="Group By..." name="group_by">
                        <filter name="type" string="Type" domain="[]" context="{'group_by':'type'}" invisible="context.get('default_type', False)"/>
                        <filter name="sta_assembly_category_id" string="Assembly Category" domain="[]" context="{'group_by':'sta_assembly_category_id'}" invisible="context.get('default_type', False)!='sta'"/>
                        <filter name="int_assembly_category_id" string="Assembly Category" domain="[]" context="{'group_by':'int_assembly_category_id'}" invisible="context.get('default_type', False)!='int'"/>
                        <filter name="ext_assembly_category_id" string="Assembly Category" domain="[]" context="{'group_by':'ext_assembly_category_id'}" invisible="context.get('default_type', False)!='ext'"/>
                    </group>
                </search>
            </field>
        </record>

        <record id="mandate_category_tree_view" model="ir.ui.view">
            <field name="name">mandate.category.tree</field>
            <field name="model">mandate.category</field>
            <field name="arch" type="xml">
                <tree string="Mandate Categories" version="7.0">
                    <field name="name"/>

                    <field name="sta_assembly_category_id" invisible="context.get('default_type', False)!='sta'"/>
                    <field name="int_assembly_category_id" invisible="context.get('default_type', False)!='int'"/>
                    <field name="ext_assembly_category_id" invisible="context.get('default_type', False)!='ext'"/>

                    <field name="expire_date"
                           invisible="context.get('invisible_expire_date', True)"/>
                    <field name="type" invisible="1"/>
                </tree>
            </field>
        </record>

        <record id="sta_candidature_search_view" model="ir.ui.view">
            <field name="name">sta.candidature.search</field>
            <field name="model">sta.candidature</field>
            <field name="inherit_id" ref="abstract_candidature_search_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='partner_id']" position="after">
                    <field name="sta_assembly_id"/>
                    <field name="electoral_district_id"/>
                    <field name="legislature_id" domain="[('active', '&lt;=', 1)]"/>
                </xpath>
                <xpath expr="//filter[@name='partner']" position="after">
                    <filter name="assembly" string="Assembly" domain="[]" context="{'group_by':'sta_assembly_id'}" />
                    <filter name="electoral_district" string="Electoral District" domain="[]" context="{'group_by':'electoral_district_id'}" />
                    <filter name="legislature" string="Legislature" domain="[]" context="{'group_by':'legislature_id'}" />
                </xpath>
            </field>
        </record>

        <record id="sta_candidature_tree_view" model="ir.ui.view">
            <field name="name">sta.candidature.tree</field>
            <field name="model">sta.candidature</field>
            <field name="inherit_id" ref="abstract_candidature_tree_view"/>
            <field name="arch" type="xml">
                <data>
                    <xpath expr="//field[@name='selection_committee_id']" position="replace">
                        <field name="sta_assembly_id"/>
                        <field name="electoral_district_id"/>
                    </xpath>
                    <xpath expr="//field[@name='partner_name']" position="before">
                        <field name="list_effective_position" string="#EP"
                               attrs="{'invisible': ['|','&amp;',('is_effective', '=', False),('is_substitute','!=',False),('state','in',['elected','non-elected','rejected'])]}"/>
                        <field name="list_substitute_position" string="#SP"
                               attrs="{'invisible': ['|',('is_substitute', '=', False),('state','in',['elected','non-elected','rejected'])]}"/>
                        <field name="election_effective_position" string="#E"
                               attrs="{'invisible': ['|',('state','!=','elected'),'&amp;',('is_effective','=',False),('is_substitute','=',True)]}"/>
                        <field name="election_substitute_position" string="#S"
                               attrs="{'invisible': ['|',('state','!=','non-elected'),'&amp;',('is_substitute','=',False),('is_effective','=',True)]}"/>
                        <field name="is_effective" invisible="1"/>
                        <field name="is_substitute" invisible="1"/>
                    </xpath>
                    <xpath expr="//field[@name='mandate_start_date']" position="replace">
                        <field name="legislature_id"/>
                    </xpath>
                </data>
            </field>
        </record>

        <record id="int_candidature_search_view" model="ir.ui.view">
            <field name="name">int.candidature.search</field>
            <field name="model">int.candidature</field>
            <field name="inherit_id" ref="abstract_candidature_search_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='partner_id']" position="after">
                    <field name="int_assembly_id"/>
                </xpath>
                <xpath expr="//filter[@name='partner']" position="after">
                    <filter name="assembly" string="Assembly" domain="[]" context="{'group_by':'int_assembly_id'}" />
                </xpath>
            </field>
        </record>

        <record id="int_candidature_tree_view" model="ir.ui.view">
            <field name="name">int.candidature.tree</field>
            <field name="model">int.candidature</field>
            <field name="inherit_id" ref="abstract_candidature_tree_view"/>
            <field name="arch" type="xml">
                <data>
                    <xpath expr="//field[@name='selection_committee_id']" position="replace">
                        <field name="int_assembly_id"/>
                    </xpath>
                </data>
            </field>
        </record>

        <record id="ext_candidature_search_view" model="ir.ui.view">
            <field name="name">ext.candidature.search</field>
            <field name="model">ext.candidature</field>
            <field name="inherit_id" ref="abstract_candidature_search_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='partner_id']" position="after">
                    <field name="ext_assembly_id"/>
                </xpath>
                <xpath expr="//filter[@name='partner']" position="after">
                    <filter name="assembly" string="Assembly" domain="[]" context="{'group_by':'ext_assembly_id'}" />
                </xpath>
            </field>
        </record>

        <record id="ext_candidature_tree_view" model="ir.ui.view">
            <field name="name">ext.candidature.tree</field>
            <field name="model">ext.candidature</field>
            <field name="inherit_id" ref="abstract_candidature_tree_view"/>
            <field name="arch" type="xml">
                <data>
                    <xpath expr="//field[@name='selection_committee_id']" position="replace">
                        <field name="ext_assembly_id"/>
                    </xpath>
                </data>
            </field>
        </record>

        <record id="sta_mandate_search_view" model="ir.ui.view">
            <field name="name">sta.mandate.search</field>
            <field name="model">sta.mandate</field>
            <field name="inherit_id" ref="abstract_mandate_search_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='partner_id']" position="after">
                    <field name="sta_assembly_id"/>
                    <field name="legislature_id" domain="[('active', '&lt;=', 1)]"/>
                    <field name="competencies_m2m_ids" widget="many2one" />
                </xpath>
                <xpath expr="//filter[@name='partner']" position="after">
                    <filter name="assembly" string="Assembly" domain="[]" context="{'group_by':'sta_assembly_id'}" />
                    <filter name="legislature" string="Legislature" domain="[]" context="{'group_by':'legislature_id'}" />
                </xpath>
            </field>
        </record>

        <record id="int_mandate_search_view" model="ir.ui.view">
            <field name="name">int.mandate.search</field>
            <field name="model">int.mandate</field>
            <field name="inherit_id" ref="abstract_mandate_search_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='partner_id']" position="after">
                    <field name="int_assembly_id"/>
                </xpath>
                <xpath expr="//filter[@name='is_submission_mandate']" position="replace"/>
                <xpath expr="//filter[@name='is_submission_assets']" position="replace"/>
                <xpath expr="//filter[@name='partner']" position="after">
                    <filter name="assembly" string="Assembly" domain="[]" context="{'group_by':'int_assembly_id'}" />
                </xpath>
            </field>
        </record>

        <record id="ext_mandate_search_view" model="ir.ui.view">
            <field name="name">ext.mandate.search</field>
            <field name="model">ext.mandate</field>
            <field name="inherit_id" ref="abstract_mandate_search_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='partner_id']" position="after">
                    <field name="ext_assembly_id"/>
                    <field name="competencies_m2m_ids" widget="many2one" />
                </xpath>
                <xpath expr="//filter[@name='partner']" position="after">
                    <filter name="assembly" string="Assembly" domain="[]" context="{'group_by':'ext_assembly_id'}" />
                </xpath>
            </field>
        </record>

        <record id="sta_mandate_tree_view" model="ir.ui.view">
            <field name="name">sta.mandate.tree</field>
            <field name="model">sta.mandate</field>
            <field name="inherit_id" ref="abstract_mandate_tree_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='mandate_category_id']" position="after">
                    <field name="sta_assembly_id"/>
                    <field name="legislature_id"/>
                </xpath>
                <xpath expr="//field[@name='start_date']" position="replace"/>
                <xpath expr="//field[@name='deadline_date']" position="replace"/>
                <xpath expr="//field[@name='expire_date']" position="before">
                    <button name="%(copy_sta_mandate_action)d" string="Renew or Add Complementary Mandate" type="action" icon="gtk-copy"/>
                </xpath>
            </field>
        </record>

        <record id="int_mandate_tree_view" model="ir.ui.view">
            <field name="name">int.mandate.tree</field>
            <field name="model">int.mandate</field>
            <field name="inherit_id" ref="abstract_mandate_tree_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='mandate_category_id']" position="after">
                    <field name="int_assembly_id"/>
                </xpath>
                <xpath expr="//field[@name='expire_date']" position="before">
                    <button name="%(copy_int_mandate_action)d" string="Renew or Add Complementary Mandate" type="action" icon="gtk-copy"/>
                </xpath>
            </field>
        </record>

        <record id="ext_mandate_tree_view" model="ir.ui.view">
            <field name="name">ext.mandate.tree</field>
            <field name="model">ext.mandate</field>
            <field name="inherit_id" ref="abstract_mandate_tree_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='mandate_category_id']" position="after">
                    <field name="ext_assembly_id"/>
                </xpath>
                <xpath expr="//field[@name='expire_date']" position="before">
                    <button name="%(copy_ext_mandate_action)d" string="Renew or Add Complementary Mandate" type="action" icon="gtk-copy"/>
                </xpath>
            </field>
        </record>

        <record id="sta_selection_committee_tree_view" model="ir.ui.view">
            <field name="name">sta.selection.committee.tree</field>
            <field name="model">sta.selection.committee</field>
            <field name="inherit_id" ref="abstract_selection_committee_tree_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='assembly_id']" position="after">
                   <field name="electoral_district_id"/>
                </xpath>
                <xpath expr="//field[@name='mandate_start_date']" position="replace">
                   <field name="legislature_id"/>
                </xpath>
            </field>
        </record>

         <record id="sta_selection_committee_search_view" model="ir.ui.view">
            <field name="name">sta.selection.committee.search</field>
            <field name="model">sta.selection.committee</field>
            <field name="inherit_id" ref="abstract_selection_committee_search_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='assembly_id']" position="after">
                   <field name="electoral_district_id"/>
                   <field name="legislature_id" domain="[('active', '&lt;=', 1)]"/>
                </xpath>
                <xpath expr="//filter[@name='assembly']" position="after">
                   <filter name="electoral_district" string="Electoral District" domain="[]" context="{'group_by':'electoral_district_id'}" />
                   <filter name="legislature" string="Legislature" domain="[]" context="{'group_by':'legislature_id'}" />
                </xpath>
            </field>
        </record>

         <!-- Actions -->

        <record id="sta_mandate_category_action" model="ir.actions.act_window">
            <field name="name">State Categories</field>
            <field name="res_model">mandate.category</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="mandate_category_search_view" />
            <field name="view_id" ref="mandate_category_tree_view" />
            <field name="context">{'default_type': 'sta'}</field>
            <field name="domain">[('type', '=', 'sta')]</field>
        </record>

        <record id="int_mandate_category_action" model="ir.actions.act_window">
            <field name="name">Internal Categories</field>
            <field name="res_model">mandate.category</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="mandate_category_search_view" />
            <field name="view_id" ref="mandate_category_tree_view" />
            <field name="context">{'default_type': 'int'}</field>
            <field name="domain">[('type', '=', 'int')]</field>
        </record>

        <record id="ext_mandate_category_action" model="ir.actions.act_window">
            <field name="name">External Categories</field>
            <field name="res_model">mandate.category</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="mandate_category_search_view" />
            <field name="view_id" ref="mandate_category_tree_view" />
            <field name="context">{'default_type': 'ext'}</field>
            <field name="domain">[('type', '=', 'ext')]</field>
        </record>

        <record id="sta_candidature_action" model="ir.actions.act_window">
            <field name="name">State Candidatures</field>
            <field name="res_model">sta.candidature</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="sta_candidature_search_view" />
            <field name="view_id" ref="sta_candidature_tree_view" />
        </record>

        <record id="int_candidature_action" model="ir.actions.act_window">
            <field name="name">Internal Candidatures</field>
            <field name="res_model">int.candidature</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="int_candidature_search_view" />
            <field name="view_id" ref="int_candidature_tree_view" />
        </record>

        <record id="ext_candidature_action" model="ir.actions.act_window">
            <field name="name">External Candidatures</field>
            <field name="res_model">ext.candidature</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="ext_candidature_search_view" />
            <field name="view_id" ref="ext_candidature_tree_view" />
        </record>

        <record id="sta_mandate_action" model="ir.actions.act_window">
            <field name="name">State Mandates</field>
            <field name="res_model">sta.mandate</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="sta_mandate_search_view" />
            <field name="view_id" ref="sta_mandate_tree_view" />
        </record>

        <record id="int_mandate_action" model="ir.actions.act_window">
            <field name="name">Internal Mandates</field>
            <field name="res_model">int.mandate</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="int_mandate_search_view" />
            <field name="view_id" ref="int_mandate_tree_view" />
        </record>

        <record id="ext_mandate_action" model="ir.actions.act_window">
            <field name="name">External Mandates</field>
            <field name="res_model">ext.mandate</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="ext_mandate_search_view" />
            <field name="view_id" ref="ext_mandate_tree_view" />
        </record>

        <record id="sta_selection_committee_action" model="ir.actions.act_window">
            <field name="name">Selection Committee</field>
            <field name="res_model">sta.selection.committee</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="sta_selection_committee_search_view" />
            <field name="view_id" ref="sta_selection_committee_tree_view" />
        </record>

        <record id="int_selection_committee_action" model="ir.actions.act_window">
            <field name="name">Selection Committee</field>
            <field name="res_model">int.selection.committee</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="abstract_selection_committee_search_view" />
            <field name="view_id" ref="abstract_selection_committee_tree_view" />
        </record>

        <record id="ext_selection_committee_action" model="ir.actions.act_window">
            <field name="name">Selection Committee</field>
            <field name="res_model">ext.selection.committee</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="abstract_selection_committee_search_view" />
            <field name="view_id" ref="abstract_selection_committee_tree_view" />
        </record>

         <!-- Form Views -->

        <record id="mandate_category_form_view" model="ir.ui.view">
            <field name="name">mandate.category.form</field>
            <field name="model">mandate.category</field>
            <field name="arch" type="xml">
                <form string="Mandate Category" version="7.0">
                    <header>
                         <div attrs="{'invisible': ['|',('id','=',False),('active','=',False)]}"
                             invisible="context.get('popup')"
                             groups="mozaik_base.mozaik_res_groups_user">
                            <button name="action_invalidate" string="Invalidate" type="object"
                                    confirm="Invalidate category: proceed anyway?" />
                        </div>
                    </header>
                    <sheet>
                        <div class="oe_title">
                            <label for="name" class="oe_edit_only"/>
                            <h1><field name="name"/></h1>
                        </div>
                        <div class="oe_right oe_button_box" name="buttons" invisible="context.get('popup')">
                            <button string="Candidatures" name="%(sta_candidature_action)d"
                                type="action" attrs="{'invisible': ['|',('id','=',False),('type','!=','sta')]}"
                                context="{'search_default_mandate_category_id': active_id,
                                          'default_mandate_category_id': active_id}" />
                            <button string="Mandates" name="%(sta_mandate_action)d"
                                type="action" attrs="{'invisible': ['|',('id','=',False),('type','!=','sta')]}"
                                context="{'search_default_mandate_category_id': active_id,
                                          'default_mandate_category_id': active_id}" />
                            <button string="Candidatures" name="%(int_candidature_action)d"
                                type="action" attrs="{'invisible': ['|',('id','=',False),('type','!=','int')]}"
                                context="{'search_default_mandate_category_id': active_id,
                                          'default_mandate_category_id': active_id}" />
                            <button string="Mandates" name="%(int_mandate_action)d"
                                type="action" attrs="{'invisible': ['|',('id','=',False),('type','!=','int')]}"
                                context="{'search_default_mandate_category_id': active_id,
                                          'default_mandate_category_id': active_id}" />
                            <button string="Candidatures" name="%(ext_candidature_action)d"
                                type="action" attrs="{'invisible': ['|',('id','=',False),('type','!=','ext')]}"
                                context="{'search_default_mandate_category_id': active_id,
                                          'default_mandate_category_id': active_id}" />
                            <button string="Mandates" name="%(ext_mandate_action)d"
                                type="action" attrs="{'invisible': ['|',('id','=',False),('type','!=','ext')]}"
                                context="{'search_default_mandate_category_id': active_id,
                                          'default_mandate_category_id': active_id}" />
                        </div>

                        <group name="data">
                            <group name="main">
                                <field name="type" invisible="context.get('default_type')" attrs="{'invisible': [('id','!=',False)]}"/>
                                <field name="sta_assembly_category_id" attrs="{'invisible': [('type','!=','sta')],
                                                                               'required':[('type','=','sta')] }"/>
                                <field name="int_assembly_category_id" attrs="{'invisible': [('type','!=','int')],
                                                                               'required':[('type','=','int')] }"/>
                               <field name="ext_assembly_category_id" attrs="{'invisible': [('type','!=','ext')],
                                                                              'required':[('type','=','ext')] }"/>
                            </group>
                            <group name="other">
                                <field name="is_submission_mandate" attrs="{'invisible': [('type','not in',['sta', 'ext'])]}"/>
                                <field name="is_submission_assets" attrs="{'invisible': [('type','not in',['sta', 'ext'])]}"/>
                            </group>
                        </group>
                        <group name="state" attrs="{'invisible': [('id','=',False)]}">
                            <group name="validity">
                                <field name="create_date" readonly="1"/>
                                <field name="expire_date" readonly="1" attrs="{'invisible': [('active','=', True)]}"/>
                            </group>
                        </group>

                        <notebook invisible="context.get('popup')">
                            <page string="Exclusive Categories" name="exclusive_categories" autofocus="autofocus">
                                <field name="exclusive_category_m2m_ids">
                                    <tree>
                                        <field name="name"/>
                                    </tree>
                                </field>
                            </page>
                        </notebook>
                    </sheet>
                    <div name="dev" class="oe_form_sheetbg" groups="mozaik_base.res_groups_developper">
                        <div class="oe_formview oe_form_sheet_width">
                            <h3>More Info</h3>
                            <div attrs="{'invisible': ['|',('id','=',False),('active','=',True)]}">
                                <button name="action_revalidate" string="Validate" type="object"
                                        confirm="Reactivate document: proceed anyway?" />
                            </div>
                            <group name="moreinfo">
                                <field name="id"/>
                                <field name="active"/>
                            </group>
                        </div>
                    </div>
                    <div name="chat" class="oe_chatter" invisible="context.get('popup')">
                        <field name="message_follower_ids" widget="mail_followers" groups="mozaik_base.mozaik_res_groups_configurator"/>
                        <field name="message_ids" widget="mail_thread" />
                    </div>
                </form>
            </field>
        </record>

        <record id="sta_candidature_form_view" model="ir.ui.view">
            <field name="name">sta.candidature.form</field>
            <field name="model">sta.candidature</field>
            <field name="inherit_id" ref="abstract_candidature_form_view"/>
            <field name="arch" type="xml">
                <xpath expr="//button[@name='action_invalidate']" position="after">
                    <button name="button_elected" string="Elected"  class="oe_highlight"
                                    confirm="Set candidature as elected: proceed anyway?"
                                    attrs="{'invisible': ['|', '|',('is_legislative', '=', False), ('state', 'not in', ['designated']),
                                                          '&amp;', ('is_effective', '=', False),('is_substitute', '=', True)]}"/>
                    <button name="button_non_elected" string="Non-Elected" class="oe_highlight"
                                    confirm="Set candidature as non-elected: proceed anyway?"
                                    attrs="{'invisible': ['|',('is_legislative', '=', False), ('state', 'not in', ['designated'])]}"/>
                </xpath>
                <xpath expr="//button[@name='button_create_mandate']" position="attributes">
                    <attribute name="attrs">{'invisible': ['|', '|', ('state','not in', ['elected', 'non-elected']),
                                                           '&amp;', ('state', '=', 'non-elected'), ('is_effective', '=', True)
                                                           , ('mandate_ids', '!=', [])]}</attribute>
                </xpath>
                <xpath expr="//field[@name='selection_committee_id']" position="after">
                     <field name="electoral_district_id" readonly="1"
                            attrs="{'invisible': [('electoral_district_id','=', False)]}"/>
                     <field name="sta_assembly_id" readonly="1"/>
                     <field name="legislature_id" readonly="1"/>
                </xpath>
                <xpath expr="//group[@name='data_2']" position="after">
                    <group name="Effective" attrs="{'invisible': ['|',('state','=','rejected'),('is_legislative', '=', False)]}">
                        <field name="is_effective" attrs="{'readonly': [('state','not in',['draft', 'declared', 'suggested'])]}"
                               on_change="onchange_effective_substitute(is_effective, is_substitute)"/>
                        <field name="list_effective_position" attrs="{'invisible':[('is_effective', '=', False), ('is_substitute', '=', True)],
                                                                      'readonly': [('state','not in',['draft', 'declared', 'suggested'])],
                                                                      'required': ['|', ('is_effective', '!=', False), ('is_substitute', '=', False)]}"/>
                        <field name="election_effective_position" attrs="{'invisible': ['|',('state','!=','elected'),'&amp;',('is_effective','=',False),('is_substitute','=',True)]}"/>
                        <field name="effective_votes" attrs="{'invisible': ['|',('state','!=','elected'),'&amp;',('is_effective','=',False),('is_substitute','=',True)]}"/>
                    </group>
                    <group name="substitute" attrs="{'invisible': ['|',('state','=','rejected'),('is_legislative', '=', False)]}">
                        <field name="is_substitute" attrs="{'readonly': [('state','not in',['draft', 'declared', 'suggested'])]}"
                               on_change="onchange_effective_substitute(is_effective, is_substitute)"/>
                        <field name="list_substitute_position" attrs="{'invisible': [('is_substitute', '=', False)],
                                                                       'readonly': [('state','not in',['draft', 'declared', 'suggested'])],
                                                                       'required': [('is_substitute', '!=', False)]}"/>
                        <field name="election_substitute_position" attrs="{'invisible': ['|',('state','!=','non-elected'),'&amp;',('is_substitute','=',False),('is_effective','=',True)]}"/>
                        <field name="substitute_votes" attrs="{'invisible': ['|',('state','!=','non-elected'),'&amp;',('is_substitute','=',False),('is_effective','=',True)]}"/>
                    </group>
                </xpath>
                <xpath  expr="//group[@name='moreinfo']" position="inside" >
                    <field name="is_legislative" />
                    <field name="sort_order" />
                </xpath>
            </field>
        </record>

        <record id="int_candidature_form_view" model="ir.ui.view">
            <field name="name">int.candidature.form</field>
            <field name="model">int.candidature</field>
            <field name="inherit_id" ref="abstract_candidature_form_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='selection_committee_id']" position="after">
                     <field name="int_assembly_id" readonly="1"/>
                     <field name="mandate_start_date" readonly="1"/>
                </xpath>
                <xpath expr="//button[@name='button_create_mandate']" position="attributes">
                     <attribute name="attrs">{'invisible': ['|', ('state','!=', 'elected'),('mandate_ids', '!=', [])]}</attribute>
                </xpath>
            </field>
        </record>

        <record id="ext_candidature_form_view" model="ir.ui.view">
            <field name="name">ext.candidature.form</field>
            <field name="model">ext.candidature</field>
            <field name="inherit_id" ref="abstract_candidature_form_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='selection_committee_id']" position="after">
                     <field name="ext_assembly_id" readonly="1"/>
                     <field name="mandate_start_date" readonly="1"/>
                </xpath>
                <xpath expr="//button[@name='button_create_mandate']" position="attributes">
                     <attribute name="attrs">{'invisible': ['|', ('state','!=', 'elected'), ('mandate_ids', '!=', [])]}</attribute>
                </xpath>
            </field>
        </record>

        <record id="sta_mandate_form_view" model="ir.ui.view">
            <field name="name">sta.mandate.form</field>
            <field name="model">sta.mandate</field>
            <field name="inherit_id" ref="abstract_mandate_form_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='email_coordinate_id']" position="before">
                    <field name="sta_assembly_id" attrs="{'readonly': [('candidature_id','!=',False)]}"
                            required="1"
                            domain="[('assembly_category_id', '=', sta_assembly_category_id)]"
                            on_change="onchange_sta_assembly_id(sta_assembly_id)"/>
                    <field name="legislature_id" attrs="{'readonly': [('candidature_id','!=',False)]}"
                                                 domain="[('power_level_id','=',sta_power_level_id),('deadline_date', '>', time.strftime('%%Y-%%m-%%d'))]"
                                                 on_change="onchange_legislature_id(legislature_id)"/>

                </xpath>

                <xpath expr="//field[@name='mandate_category_id']" position="attributes">
                    <attribute name="on_change">onchange_mandate_category_id(mandate_category_id)</attribute>
                    <attribute name="context">{'default_type': 'sta'}</attribute>
                </xpath>

                <xpath expr="//group[@name='data']" position="after">
                    <notebook>
                        <page name="index" string="Indexation">
                            <separator string="Remits"/>
                            <field name="competencies_m2m_ids"/>
                        </page>
                    </notebook>
                </xpath>

                <xpath expr="//group[@name='moreinfo']" position="inside">
                    <field name="sta_assembly_category_id"/>
                    <field name="sta_power_level_id"/>
                </xpath>
            </field>
        </record>

        <record id="int_mandate_form_view" model="ir.ui.view">
            <field name="name">int.mandate.form</field>
            <field name="model">int.mandate</field>
            <field name="inherit_id" ref="abstract_mandate_form_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='email_coordinate_id']" position="before">
                    <field name="int_assembly_id" attrs="{'readonly': [('candidature_id','!=',False)]}"
                            required="1"
                            domain="[('assembly_category_id', '=', int_assembly_category_id)]"
                            on_change="onchange_int_assembly_id(int_assembly_id)"/>
                </xpath>

                <xpath expr="//field[@name='is_submission_mandate']" position="replace"/>
                <xpath expr="//field[@name='is_submission_assets']" position="replace"/>

                <xpath expr="//field[@name='mandate_category_id']" position="attributes">
                    <attribute name="on_change">onchange_mandate_category_id(mandate_category_id)</attribute>
                    <attribute name="context">{'default_type': 'int'}</attribute>
                </xpath>

                <xpath expr="//field[@name='end_date']" position="after">
                    <field name="months_before_end_of_mandate"/>
                </xpath>

                <xpath expr="//group[@name='moreinfo']" position="inside">
                    <field name="int_assembly_category_id"/>
                    <field name="is_submission_mandate"/>
                    <field name="is_submission_assets"/>
                </xpath>
            </field>
        </record>

        <record id="ext_mandate_form_view" model="ir.ui.view">
            <field name="name">ext.mandate.form</field>
            <field name="model">ext.mandate</field>
            <field name="inherit_id" ref="abstract_mandate_form_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='email_coordinate_id']" position="before">
                    <field name="ext_assembly_id" attrs="{'readonly': [('candidature_id','!=',False)]}"
                            required="1"
                            domain="[('assembly_category_id', '=', ext_assembly_category_id)]"
                            on_change="onchange_ext_assembly_id(ext_assembly_id)"/>
                </xpath>

                <xpath expr="//field[@name='mandate_category_id']" position="attributes">
                    <attribute name="on_change">onchange_mandate_category_id(mandate_category_id)</attribute>
                    <attribute name="context">{'default_type': 'ext'}</attribute>
                </xpath>

                <xpath expr="//field[@name='end_date']" position="after">
                    <field name="months_before_end_of_mandate"/>
                </xpath>

                <xpath expr="//group[@name='data']" position="after">
                    <notebook>
                        <page name="index" string="Indexation">
                            <separator string="Remits"/>
                            <field name="competencies_m2m_ids"/>
                        </page>
                    </notebook>
                </xpath>

                <xpath expr="//group[@name='moreinfo']" position="inside">
                    <field name="ext_assembly_category_id"/>
                </xpath>
            </field>
        </record>

        <record id="sta_selection_committee_form_view" model="ir.ui.view">
            <field name="name">sta.selection.committee.form</field>
            <field name="model">sta.selection.committee</field>
            <field name="inherit_id" ref="abstract_selection_committee_form_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='assembly_id']" position="attributes">
                    <attribute name="attrs">{'readonly': [('electoral_district_id','!=', False)]}</attribute>
                    <attribute name="domain">[('is_legislative', '=', False)]</attribute>
                </xpath>
                <xpath expr="//field[@name='assembly_id']" position="before">
                       <field name="electoral_district_id"
                             attrs="{'required': [('assembly_id','=', False),],
                                     'invisible': [('assembly_id','!=', False),('electoral_district_id','=', False)]}"
                             on_change="onchange_electoral_district_id(electoral_district_id)"/>
                </xpath>

                <xpath expr="//field[@name='assembly_id']" position="after">
                    <field name="legislature_id" readonly="1"
                             required="1"
                             on_change="onchange_legislature_id(legislature_id)"
                             domain="[('deadline_date', '>', time.strftime('%%Y-%%m-%%d'))]"/>
                </xpath>

                <xpath expr="//field[@name='mandate_start_date']" position="before">
                    <field name="mandate_category_id"
                           required="1"
                           domain="[('type', '=', 'sta'), ('sta_assembly_category_id', '=', assembly_category_id)]"
                           context="{'default_type': 'sta'}"
                           on_change="onchange_mandate_category_id(mandate_category_id)"/>
                </xpath>

                <xpath expr="//field[@name='designation_int_assembly_id']" position="attributes">
                    <attribute name="attrs">{'readonly': [('electoral_district_id','!=', False),]}</attribute>
                </xpath>

                <xpath expr="//page[@name='candidatures']" position="inside">
                    <button string="All Details" name="%(sta_candidature_action)d"
                                        type="action" attrs="{'invisible': [('id','=',False)]}"
                                        context="{'search_default_selection_committee_id': active_id,
                                                  'default_selection_committee_id': active_id,
                                                  'search_default_all': True}" />
                    <button string="Accept" name="button_accept_candidatures" type="object" class="oe_highlight"
                            attrs="{'invisible': [('state','=','done')]}"
                            confirm="Accept all candidatures: proceed anyway?"/>
                    <button string="Refuse" name="button_refuse_candidatures" type="object" class="oe_highlight"
                            attrs="{'invisible': [('state','=','done')]}"
                            confirm="Refuse all candidatures: proceed anyway?"/>
                    <field name="candidature_ids" context="{'default_selection_committee_id': active_id}" attrs="{'readonly': [('decision_date', '!=', False)]}">
                        <tree colors="red:state=='declared';grey:active==False">
                            <field name="list_effective_position" string="#EP"
                                   attrs="{'invisible': [('is_effective', '=', False),('is_substitute', '!=', False)]}"/>
                            <field name="list_substitute_position" string="#SP"
                                   attrs="{'invisible': [('is_substitute', '=', False)]}"/>
                            <field name="partner_name"/>
                            <field name="state"/>
                            <button name="button_suggest" string="Suggest" icon="gtk-apply"
                                    attrs="{'invisible': ['|',('state', '!=', 'declared'),('is_selection_committee_active', '=', False)]}"/>
                            <button name="button_reject" string="Reject" icon="gtk-cancel"
                                    attrs="{'invisible': ['|',('state', '!=', 'declared'),('is_selection_committee_active', '=', False)]}"/>
                            <button name="button_declare" string="Back to Declared" icon="gtk-undo"
                                    attrs="{'invisible': ['|',('state', 'not in',['rejected','suggested']),('is_selection_committee_active', '=', False)]}"/>
                            <field name="active" invisible="1"/>
                            <field name="is_effective" invisible="1"/>
                            <field name="is_substitute" invisible="1"/>
                            <field name="is_selection_committee_active" invisible="1"/>
                        </tree>
                    </field>
                </xpath>

                <xpath expr="//page[@name='note']" position="after">
                    <page string="List" name="list"
                          attrs="{'invisible': [('electoral_district_id', '=', False)]}">
                        <group>
                            <field name="listname"/>
                            <field name="is_cartel"/>
                            <field name="cartel_composition"
                                   attrs="{'invisible': [('is_cartel', '=', False)]}"/>
                        </group>
                    </page>

                </xpath>
            </field>
        </record>

        <record id="sta_selection_committee_officer_form_view" model="ir.ui.view">
            <field name="name">sta.selection.committee.officer.form</field>
            <field name="model">sta.selection.committee</field>
            <field name="inherit_id" ref="abstract_selection_committee_form_view"/>
            <field name="groups_id" eval="[(6,0,[
                ref('mozaik_base.mozaik_res_groups_officer'),
            ])]"/>
            <field name="arch" type="xml">
                <xpath expr="//page[@name='candidatures']" position="after">
                    <page string="Members" name="members" invisible="context.get('popup')">
                        <field name="partner_ids" context="{'default_is_company': False}">
                            <tree>
                                <field name="display_name"/>
                            </tree>
                        </field>
                    </page>
                </xpath>
            </field>
        </record>

        <record id="int_selection_committee_form_view" model="ir.ui.view">
            <field name="name">int.selection.committee.form</field>
            <field name="model">int.selection.committee</field>
            <field name="inherit_id" ref="abstract_selection_committee_form_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='auto_mandate']" position="before">
                    <field name="is_virtual"/>
                </xpath>
                <xpath expr="//field[@name='assembly_id']" position="attributes">
                    <attribute name="domain">[('assembly_category_id', '=', assembly_category_id)]</attribute>
                </xpath>
                <xpath expr="//field[@name='assembly_id']" position="before">
                        <field name="mandate_category_id"
                           required="1"
                           domain="[('type', '=', 'int')]"
                           context="{'default_type': 'int'}"
                           on_change="onchange_mandate_category_id(mandate_category_id)"/>
                </xpath>
                <xpath expr="//page[@name='candidatures']" position="inside">
                    <button string="All Details" name="%(int_candidature_action)d"
                                        type="action" attrs="{'invisible': [('id','=',False)]}"
                                        context="{'search_default_selection_committee_id': active_id,
                                                  'default_selection_committee_id': active_id,
                                                  'search_default_all': True}" />
                    <button string="Accept" name="button_accept_candidatures" type="object" class="oe_highlight"
                            attrs="{'invisible': [('state','=','done')]}"
                            confirm="Accept all candidatures: proceed anyway?"/>
                    <button string="Refuse" name="button_refuse_candidatures" type="object" class="oe_highlight"
                            attrs="{'invisible': [('state','=','done')]}"
                            confirm="Refuse all candidatures: proceed anyway?"/>
                    <field name="candidature_ids" context="{'default_selection_committee_id': active_id}">
                        <tree colors="red:state=='declared';grey:active==False">
                            <field name="partner_name"/>
                            <field name="state"/>
                            <button name="button_suggest" string="Suggest" icon="gtk-apply"
                                    attrs="{'invisible': ['|',('state', '!=', 'declared'),('is_selection_committee_active', '=', False)]}"/>
                            <button name="button_reject" string="Reject" icon="gtk-cancel"
                                    attrs="{'invisible': ['|',('state', '!=', 'declared'),('is_selection_committee_active', '=', False)]}"/>
                            <button name="button_declare" string="Back to Declared" icon="gtk-undo"
                                    attrs="{'invisible': ['|',('state', 'not in',['rejected','suggested']),('is_selection_committee_active', '=', False)]}"/>
                            <field name="active" invisible="1"/>
                            <field name="is_selection_committee_active" invisible="1"/>
                        </tree>
                    </field>
                </xpath>
            </field>
        </record>

        <record id="int_selection_committee_officer_form_view" model="ir.ui.view">
            <field name="name">int.selection.committee.officer.form</field>
            <field name="model">int.selection.committee</field>
            <field name="inherit_id" ref="abstract_selection_committee_form_view"/>
            <field name="groups_id" eval="[(6,0,[
                ref('mozaik_base.mozaik_res_groups_officer'),
            ])]"/>
            <field name="arch" type="xml">
                <xpath expr="//page[@name='candidatures']" position="after">
                    <page string="Members" name="members" invisible="context.get('popup')"
                          attrs="{'invisible': [('is_virtual','=',True)]}" >
                        <field name="partner_ids" context="{'default_is_company': False}">
                            <tree>
                                <field name="display_name"/>
                            </tree>
                        </field>
                    </page>
                </xpath>
            </field>
        </record>

        <record id="ext_selection_committee_form_view" model="ir.ui.view">
            <field name="name">ext.selection.committee.form</field>
            <field name="model">ext.selection.committee</field>
            <field name="inherit_id" ref="abstract_selection_committee_form_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='auto_mandate']" position="before">
                    <field name="is_virtual"/>
                </xpath>
                 <xpath expr="//field[@name='assembly_id']" position="attributes">
                    <attribute name="domain">[('assembly_category_id', '=', assembly_category_id)]</attribute>
                </xpath>
                <xpath expr="//field[@name='assembly_id']" position="before">
                        <field name="mandate_category_id"
                           required="1"
                           domain="[('type', '=', 'ext')]"
                           context="{'default_type': 'ext'}"
                           on_change="onchange_mandate_category_id(mandate_category_id)"/>
                </xpath>
                <xpath expr="//page[@name='candidatures']" position="inside">
                    <button string="All Details" name="%(ext_candidature_action)d"
                                        type="action" attrs="{'invisible': [('id','=',False)]}"
                                        context="{'search_default_selection_committee_id': active_id,
                                                  'default_selection_committee_id': active_id,
                                                  'search_default_all': True}" />
                    <button string="Accept" name="button_accept_candidatures" type="object" class="oe_highlight"
                            attrs="{'invisible': [('state','=','done')]}"
                            confirm="Accept all candidatures: proceed anyway?"/>
                    <button string="Refuse" name="button_refuse_candidatures" type="object" class="oe_highlight"
                            attrs="{'invisible': [('state','=','done')]}"
                            confirm="Refuse all candidatures: proceed anyway?"/>
                    <field name="candidature_ids" context="{'default_selection_committee_id': active_id}">
                        <tree colors="red:state=='declared';grey:active==False">
                            <field name="partner_name"/>
                            <field name="state"/>
                            <button name="button_suggest" string="Suggest" icon="gtk-apply"
                                    attrs="{'invisible': ['|',('state', '!=', 'declared'),('is_selection_committee_active', '=', False)]}"/>
                            <button name="button_reject" string="Reject" icon="gtk-cancel"
                                    attrs="{'invisible': ['|',('state', '!=', 'declared'),('is_selection_committee_active', '=', False)]}"/>
                            <button name="button_declare" string="Back to Declared" icon="gtk-undo"
                                    attrs="{'invisible': ['|',('state', 'not in',['rejected','suggested']),('is_selection_committee_active', '=', False)]}"/>
                            <field name="active" invisible="1"/>
                            <field name="is_selection_committee_active" invisible="1"/>
                        </tree>
                    </field>
                </xpath>
            </field>
        </record>

        <record id="ext_selection_committee_officer_form_view" model="ir.ui.view">
            <field name="name">ext.selection.committee.officer.form</field>
            <field name="model">ext.selection.committee</field>
            <field name="inherit_id" ref="abstract_selection_committee_form_view"/>
            <field name="groups_id" eval="[(6,0,[
                ref('mozaik_base.mozaik_res_groups_officer'),
            ])]"/>
            <field name="arch" type="xml">
                <xpath expr="//page[@name='candidatures']" position="after">
                    <page string="Members" name="members" invisible="context.get('popup')"
                          attrs="{'invisible': [('is_virtual','=',True)]}" >
                        <field name="partner_ids" context="{'default_is_company': False}">
                            <tree>
                                <field name="display_name"/>
                            </tree>
                        </field>
                    </page>
                </xpath>
            </field>
        </record>

        <record id="electoral_district_form_view" model="ir.ui.view">
            <field name="name">electoral_district.form (mozaik_mandate)</field>
            <field name="model">electoral.district</field>
            <field name="inherit_id" ref="mozaik_structure.electoral_district_form_view"/>
            <field name="arch" type="xml">
                 <xpath expr="//div[@name='buttons']" position="inside">
                    <button string="Selection Committees" name="%(sta_selection_committee_action)d"
                                type="action" attrs="{'invisible': [('id','=',False)]}"
                                context="{'search_default_electoral_district_id': active_id,
                                          'default_electoral_district_id': active_id}" />
                </xpath>
            </field>
        </record>

        <!-- Menus -->

        <menuitem id="sta_submenu" name="State"
                  sequence="10" parent="mozaik_base.mandates_root_menu" />

         <menuitem id="sta_selection_committee_submenu" action="sta_selection_committee_action"
                  sequence="10" parent="sta_submenu"/>

        <menuitem id="sta_candidature_submenu" action="sta_candidature_action"
                  sequence="20" parent="sta_submenu"/>

        <menuitem id="sta_mandate_submenu" action="sta_mandate_action"
                  sequence="30" parent="sta_submenu"/>

        <menuitem id="int_submenu" name="Internal"
                  sequence="20" parent="mozaik_base.mandates_root_menu" />

        <menuitem id="int_selection_committee_submenu" action="int_selection_committee_action"
                  sequence="10" parent="int_submenu"/>

        <menuitem id="int_candidature_submenu" action="int_candidature_action"
                  sequence="20" parent="int_submenu"/>

        <menuitem id="int_mandate_submenu" action="int_mandate_action"
                  sequence="30" parent="int_submenu"/>

        <menuitem id="ext_submenu" name="External"
                  sequence="30" parent="mozaik_base.mandates_root_menu" />

        <menuitem id="ext_selection_committee_submenu" action="ext_selection_committee_action"
                  sequence="10" parent="ext_submenu"/>

        <menuitem id="ext_candidature_submenu" action="ext_candidature_action"
                  sequence="20" parent="ext_submenu"/>

        <menuitem id="ext_mandate_submenu" action="ext_mandate_action"
                  sequence="30" parent="ext_submenu"/>

        <menuitem id="all_mandates_submenu" name="All Mandates"
                  sequence="50" parent="mozaik_base.mandates_root_menu" />

        <menuitem id="incompatible_mandates_submenu" action="generic_mandate_action"
                  sequence="10" parent="all_mandates_submenu"/>

        <menuitem id="configuration_submenu" name="Configuration"
                  sequence="90" parent="mozaik_base.mandates_root_menu"
                  groups="mozaik_base.mozaik_res_groups_configurator,mozaik_base.mozaik_res_groups_financial_manager" />

        <menuitem id="mandate_category_configuration_submenu" name="Mandate Categories"
                  sequence="10" parent="configuration_submenu" />

        <menuitem id="sta_mandate_categories_submenu" action="sta_mandate_category_action"
                  sequence="10" parent="mandate_category_configuration_submenu"/>

        <menuitem id="int_mandate_categories_submenu" action="int_mandate_category_action"
                  sequence="20" parent="mandate_category_configuration_submenu"/>

        <menuitem id="ext_mandate_categories_submenu" action="ext_mandate_category_action"
                  sequence="30" parent="mandate_category_configuration_submenu"/>

    </data>
</openerp>